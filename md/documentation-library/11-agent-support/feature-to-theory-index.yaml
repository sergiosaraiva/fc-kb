# Feature-to-Theory Mapping Index
# Purpose: Enable Feature Analyzer agent to quickly validate work items against consolidation theory
# Version: 2.0
# Last Updated: 2025-12-04
# Total Features: 55+
# Total Theory Chunk References: 1200+ (90%+ coverage)

metadata:
  version: "1.0"
  created: "2024-12-03"
  purpose: "Bidirectional mapping between feature keywords and consolidation theory"
  usage: |
    1. Search by feature keyword to find relevant theory chunks
    2. Search by IFRS standard to find affected features
    3. Search by procedure/table to link to business concepts
    4. Use for work item validation and gap identification

# =============================================================================
# SECTION 1: FEATURE TAXONOMY
# Organized by functional area with keywords, synonyms, and mappings
# =============================================================================

features:
  # ---------------------------------------------------------------------------
  # 1. CONSOLIDATION METHODS
  # ---------------------------------------------------------------------------
  global_integration:
    display_name: "Global Integration / Full Consolidation"
    keywords:
      - "global integration"
      - "full consolidation"
      - "100% consolidation"
      - "line by line"
      - "subsidiary consolidation"
      - "controlled entity"
    synonyms:
      - "global method"
      - "full method"
      - "G method"
    theory_chunks:
      primary: [47, 61, 65, 68, 155, 156, 157, 158, 160, 163, 172, 178]
      supporting: [94, 99, 163, 165, 194, 207, 229, 240, 303, 304, 309, 336, 362, 369, 389]
      examples: [157, 167, 190, 202, 228, 355, 363, 364, 504, 633, 641]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Consolidated Financial Statements - defines control and consolidation requirements"
      - code: "IFRS 3"
        relevance: "supporting"
        description: "Business Combinations - acquisition accounting"
    stored_procedures:
      - "P_CONSO_CALCULATE_BUNDLE_INTEGRATION"
      - "P_CONSO_ELIM_PARTICIPATIONS0"
      - "P_CONSO_ELIM_PARTICIPATIONS1"
      - "P_CONSO_ELIM_PARTICIPATIONS2"
      - "P_CONSO_ELIM_PARTICIPATIONS3"
      - "P_CONSO_ELIM_PARTICIPATIONS4"
    database_tables:
      - table: "TS014C0"
        column: "ConsoMethod"
        value: "G"
      - table: "TD035C2"
        purpose: "Consolidated data storage"
    elimination_codes: ["S050", "S051", "S052", "S053", "S054", "S085"]
    documentation:
      - "02-consolidation-methods/global-integration.md"
      - "03-core-calculations/minority-interest.md"
    implementation_status: "IMPLEMENTED"
    compliance_impact: "HIGH"

  equity_method:
    display_name: "Equity Method / One-Line Consolidation"
    keywords:
      - "equity method"
      - "one-line consolidation"
      - "associate"
      - "significant influence"
      - "20-50%"
      - "share of profit"
    synonyms:
      - "E method"
      - "equity accounting"
      - "associate accounting"
    theory_chunks:
      primary: [42, 48, 55, 73, 76, 81, 82, 134, 174, 175, 177, 180, 183, 186, 187, 197, 199]
      supporting: [250, 385, 386, 399, 484, 487, 488, 490, 503, 505, 544, 549, 552, 556, 580, 584, 586, 587, 590, 596, 597, 603, 610, 611, 616, 618, 619]
      examples: [167, 174, 180, 183, 484, 503, 505, 544, 552, 580, 590, 618, 619]
    ifrs_standards:
      - code: "IAS 28"
        relevance: "primary"
        description: "Investments in Associates and Joint Ventures"
      - code: "IAS 27"
        relevance: "supporting"
        description: "Separate Financial Statements"
    stored_procedures:
      - "P_CONSO_ELIM_EQUITYMETHOD"
      - "P_CONSO_ELIM" # orchestrator
    database_tables:
      - table: "TS014C0"
        column: "ConsoMethod"
        value: "E"
    elimination_codes: ["S040"]
    documentation:
      - "02-consolidation-methods/equity-method.md"
    implementation_status: "IMPLEMENTED"
    compliance_impact: "HIGH"

  proportional_method:
    display_name: "Proportional Integration / Joint Venture"
    keywords:
      - "proportional integration"
      - "joint venture"
      - "joint control"
      - "50%"
      - "shared control"
      - "proportional consolidation"
    synonyms:
      - "P method"
      - "proportional method"
      - "JV consolidation"
    theory_chunks:
      primary: [166, 167, 168, 169, 170, 171, 172, 173]
      supporting: [69, 70, 71, 72, 74, 75, 359]
      examples: [167, 168, 169]
    ifrs_standards:
      - code: "IFRS 11"
        relevance: "primary"
        description: "Joint Arrangements - joint ventures vs joint operations"
      - code: "IAS 28"
        relevance: "supporting"
        description: "Equity method alternative for JVs"
    stored_procedures:
      - "P_CONSO_ELIM_PROPORTIONAL"
    database_tables:
      - table: "TS014C0"
        column: "ConsoMethod"
        value: "P"
    elimination_codes: ["S060"]
    documentation:
      - "02-consolidation-methods/proportional-method.md"
    implementation_status: "IMPLEMENTED"
    compliance_impact: "MEDIUM"

  consolidation_method_determination:
    display_name: "Consolidation Method Determination"
    keywords:
      - "method determination"
      - "control threshold"
      - "ownership threshold"
      - "consolidation scope"
      - "significant influence"
      - "which method"
    synonyms:
      - "method selection"
      - "scope determination"
    theory_chunks:
      primary: [44, 45, 46, 49, 57, 133, 134]
      supporting: [34, 76, 141, 142]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Control definition"
      - code: "IAS 28"
        relevance: "supporting"
        description: "Significant influence definition"
    stored_procedures:
      - "P_CALC_OWNERSHIP_INDIRECT_PERCENTAGES"
    database_tables:
      - table: "TS014C0"
        columns: ["ConsoMethod", "GroupCtrlPerc", "GroupFinPerc"]
    documentation:
      - "02-consolidation-methods/consolidation-method-determination.md"
    implementation_status: "IMPLEMENTED"
    business_rules:
      - ">50% control → Global Integration (G)"
      - "20-50% significant influence → Equity Method (E)"
      - "50% joint control → Proportional (P)"
      - "<20% → Not Consolidated (N)"

  # ---------------------------------------------------------------------------
  # 2. OWNERSHIP & PERCENTAGES
  # ---------------------------------------------------------------------------
  ownership_percentages:
    display_name: "Ownership Percentages"
    keywords:
      - "ownership percentage"
      - "financial percentage"
      - "control percentage"
      - "voting rights"
      - "economic interest"
      - "FinPerc"
      - "CtrlPerc"
    synonyms:
      - "shareholding"
      - "stake"
      - "holding percentage"
    theory_chunks:
      primary: [44, 45, 90, 91, 92, 93, 133]
      supporting: [50, 51, 52, 53, 54, 58, 59, 60, 107]
    stored_procedures:
      - "P_CALC_OWNERSHIP_DIRECT_PERCENTAGES"
      - "P_CALC_OWNERSHIP_INDIRECT_PERCENTAGES"
    database_tables:
      - table: "TS015S0"
        columns: ["FinPercentage", "CtrlPercentage"]
      - table: "TS014C0"
        columns: ["GroupFinPerc", "GroupCtrlPerc", "DirectFinPerc"]
    documentation:
      - "06-ownership-structure/ownership-percentages.md"
    implementation_status: "IMPLEMENTED"

  direct_indirect_holdings:
    display_name: "Direct and Indirect Holdings"
    keywords:
      - "direct ownership"
      - "indirect ownership"
      - "holding chain"
      - "ownership path"
      - "intermediate holding"
      - "multi-tier"
    synonyms:
      - "ownership chain"
      - "holding structure"
    theory_chunks:
      primary: [58, 59, 60, 63, 64, 65, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106]
      supporting: [108, 109, 110, 111, 112, 113, 114, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
      examples: [63, 96, 102, 145, 203, 219, 224, 365, 545, 591, 600]
    stored_procedures:
      - "P_CALC_OWNERSHIP_INDIRECT_PERCENTAGES"
    database_tables:
      - table: "TS015S0"
        purpose: "Direct ownership links"
      - table: "TS014C0"
        purpose: "Calculated group percentages"
    documentation:
      - "06-ownership-structure/direct-indirect-holdings.md"
      - "06-ownership-structure/multi-tier-holdings.md"
    implementation_status: "IMPLEMENTED"
    algorithm: "Matrix algebra: G = D + G×D"

  circular_ownership:
    display_name: "Circular Ownership / Cross-Participation"
    keywords:
      - "circular ownership"
      - "cross-participation"
      - "reciprocal ownership"
      - "cross-shareholding"
      - "A owns B, B owns A"
    synonyms:
      - "mutual ownership"
      - "cross-holdings"
    theory_chunks:
      primary: [83, 84, 85, 86, 87, 88, 89, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126]
      supporting: [127, 128, 129, 130, 131, 132, 135, 136, 137, 138, 139, 140, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217]
      examples: [109, 110, 135, 145, 208, 212, 365, 612, 818, 1198, 1230]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "supporting"
        description: "Complex ownership structures"
    stored_procedures:
      - "P_CALC_OWNERSHIP_INDIRECT_PERCENTAGES"
    database_tables:
      - table: "TS015S0"
        purpose: "Ownership links forming cycles"
    documentation:
      - "03-core-calculations/circular-ownership.md"
    implementation_status: "IMPLEMENTED"
    implementation_note: "Uses Gauss elimination matrix inversion for solving circular structures"
    algorithm: "[A]^-1 = [I-A]^-1"

  treasury_shares:
    display_name: "Treasury Shares / Own Shares"
    keywords:
      - "treasury shares"
      - "own shares"
      - "share buyback"
      - "repurchased shares"
      - "self-owned shares"
    synonyms:
      - "treasury stock"
      - "self-held shares"
    theory_chunks:
      primary: [83, 84, 85, 86, 87, 88, 89]
      supporting: [116, 117, 118, 119, 120, 121, 122]
    ifrs_standards:
      - code: "IAS 32"
        relevance: "primary"
        description: "Financial Instruments - Presentation"
    stored_procedures: []  # GAP
    database_tables: []  # GAP
    documentation:
      - "03-core-calculations/treasury-shares.md"
      - "10-gap-analysis/missing-features.md"
    implementation_status: "NOT_IMPLEMENTED"
    gap_severity: 8
    workaround: "Manually adjust ownership percentages"
    compliance_impact: "MEDIUM"

  # ---------------------------------------------------------------------------
  # 3. GOODWILL & ACQUISITION
  # ---------------------------------------------------------------------------
  goodwill_calculation:
    display_name: "Goodwill Calculation"
    keywords:
      - "goodwill"
      - "acquisition"
      - "purchase price"
      - "fair value"
      - "consideration"
      - "business combination"
      - "excess purchase price"
    synonyms:
      - "acquisition premium"
      - "acquisition goodwill"
    theory_chunks:
      primary: [41, 269, 297, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 354, 355, 356, 357, 358, 359, 360]
      supporting: [394, 397, 416, 421, 428, 434, 435, 452, 453, 454, 502, 506, 507, 523, 526, 527, 528, 563, 566, 567, 568, 637, 638, 639, 640, 666, 668, 669, 670, 671, 672, 675, 676, 677, 678, 679, 688, 689, 690, 691, 692, 693, 695, 701, 704, 729, 730, 731, 732, 733, 734, 753, 754, 755, 756, 762, 763, 764, 767, 768, 770, 773, 784, 792, 793, 794, 798, 801, 810, 814, 816, 834, 841, 842, 843, 844, 845, 847, 848, 849, 864, 885, 887]
      examples: [41, 269, 334, 340, 355, 394, 507, 523, 666, 770, 810, 816]
    ifrs_standards:
      - code: "IFRS 3"
        relevance: "primary"
        description: "Business Combinations"
      - code: "IAS 36"
        relevance: "supporting"
        description: "Impairment of Assets"
    stored_procedures:
      - "P_REPORT_GOODWILL"
    database_tables:
      - table: "TD045C2"
        purpose: "Goodwill journals"
    elimination_codes: ["S050", "S051", "S052", "S053", "S054"]
    documentation:
      - "03-core-calculations/goodwill-calculation.md"
    implementation_status: "PARTIAL"
    gap_note: "Reporting only, manual adjustment workflow for goodwill posting"
    formula: "Goodwill = Consideration + NCI - FV Net Assets"

  bargain_purchase:
    display_name: "Bargain Purchase / Negative Goodwill"
    keywords:
      - "bargain purchase"
      - "negative goodwill"
      - "badwill"
      - "gain on acquisition"
    synonyms:
      - "negative acquisition difference"
    theory_chunks:
      primary: [327, 328, 329, 330, 331]
      supporting: [332]
    ifrs_standards:
      - code: "IFRS 3"
        relevance: "primary"
        description: "IFRS 3.34 - recognize gain in P&L"
    documentation:
      - "03-core-calculations/goodwill-calculation.md"
    implementation_status: "IMPLEMENTED"
    note: "Recognized immediately in P&L per IFRS 3.34"

  step_acquisition:
    display_name: "Step Acquisition / Incremental Purchase"
    keywords:
      - "step acquisition"
      - "incremental purchase"
      - "staged acquisition"
      - "additional shares"
      - "increasing stake"
      - "method change"
    synonyms:
      - "business combination achieved in stages"
      - "multiple transactions"
    theory_chunks:
      primary: [422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 731]
      supporting: [559, 560, 561, 562, 563, 564, 565, 566, 567, 568]
      examples: [422, 429, 559, 701]
    ifrs_standards:
      - code: "IFRS 3"
        relevance: "primary"
        description: "Remeasurement of previously held equity interest"
    stored_procedures:
      - "P_CONSO_ELIM_CHANGE_METHOD"
    elimination_codes: ["S072"]
    flow_codes: ["VarConsoMeth_EG", "VarConsoMeth_PG"]
    documentation:
      - "03-core-calculations/step-acquisition.md"
      - "10-gap-analysis/missing-features.md"
    implementation_status: "NOT_AUTOMATED"
    gap_severity: 8
    workaround: "Manual calculation of remeasurement gain/loss"

  impairment_testing:
    display_name: "Goodwill Impairment Testing"
    keywords:
      - "impairment"
      - "impairment test"
      - "recoverable amount"
      - "cash generating unit"
      - "CGU"
      - "value in use"
    synonyms:
      - "goodwill write-down"
      - "impairment review"
    theory_chunks:
      primary: [333, 335, 337]  # Limited coverage in source material
    ifrs_standards:
      - code: "IAS 36"
        relevance: "primary"
        description: "Impairment of Assets"
    documentation:
      - "03-core-calculations/impairment-testing.md"
      - "10-gap-analysis/missing-features.md"
    implementation_status: "NOT_IMPLEMENTED"
    gap_severity: 8
    workaround: "External calculation, manual entry via user elimination"

  # ---------------------------------------------------------------------------
  # 4. MINORITY INTEREST / NCI
  # ---------------------------------------------------------------------------
  minority_interest:
    display_name: "Minority Interest / Non-Controlling Interest (NCI)"
    keywords:
      - "minority interest"
      - "non-controlling interest"
      - "NCI"
      - "third party interest"
      - "external shareholders"
      - "minority shareholders"
    synonyms:
      - "MI"
      - "non-controlling equity"
    theory_chunks:
      primary: [27, 50, 66, 67, 100, 114, 121, 131, 138, 149, 154, 159, 161, 162, 164, 165, 170, 211, 215, 216, 230, 241, 306, 312, 313, 315, 347, 350, 370, 380, 391, 440, 451, 470, 471, 473, 476, 480, 482, 525, 529, 542, 543, 548, 578, 594, 598, 617, 636, 645, 655, 656, 657, 658, 659, 700, 735, 776, 795, 822, 827, 829, 846, 855, 886, 962, 963, 976, 980, 985, 995, 1030, 1049, 1055, 1056, 1060, 1071, 1072, 1078, 1080, 1081, 1082, 1083, 1086, 1090, 1150, 1151, 1156, 1160, 1161, 1182, 1183, 1184, 1234, 1239, 1255, 1263, 1264, 1278, 1316, 1317, 1324]
      examples: [27, 50, 162, 211, 306, 440, 525, 636, 655, 776, 855, 962]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "NCI definition and presentation"
      - code: "IFRS 3"
        relevance: "supporting"
        description: "NCI measurement options at acquisition"
    stored_procedures:
      - "P_CONSO_ELIM_MINORITYINTEREST"
    database_tables:
      - table: "TS014C0"
        column: "MinorityPerc"
      - table: "TD045C2"
        purpose: "MI journals"
    elimination_codes: ["S085"]
    documentation:
      - "03-core-calculations/minority-interest.md"
    implementation_status: "IMPLEMENTED"
    formula: "NCI = (100% - Group%) × Subsidiary Equity"
    nci_options:
      - "Fair Value (full goodwill)"
      - "Proportionate share (partial goodwill)"

  # ---------------------------------------------------------------------------
  # 5. ELIMINATIONS
  # ---------------------------------------------------------------------------
  dividend_elimination:
    display_name: "Dividend Elimination"
    keywords:
      - "dividend elimination"
      - "intercompany dividend"
      - "dividend received"
      - "dividend paid"
      - "upstream dividend"
      - "downstream dividend"
    synonyms:
      - "dividend adjustment"
      - "IC dividend"
    theory_chunks:
      primary: [297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 500, 514, 538, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 892, 914, 1064, 1065, 1066, 1067, 1074]
      supporting: [74, 75]
      examples: [300, 306, 500, 514, 538, 652, 892]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Elimination of intragroup transactions"
    stored_procedures:
      - "P_CONSO_ELIM_DIVIDEND"
    elimination_codes: ["S020"]
    documentation:
      - "04-elimination-entries/dividend-eliminations.md"
      - "04-elimination-entries/dividend-calculation-logic.md"
    implementation_status: "IMPLEMENTED"
    journal_structure: "4-line journal"

  participation_elimination:
    display_name: "Participation / Investment Elimination"
    keywords:
      - "participation elimination"
      - "investment elimination"
      - "eliminate investment"
      - "investment vs equity"
      - "capital elimination"
    synonyms:
      - "equity elimination"
      - "investment offset"
    theory_chunks:
      primary: [40, 62, 95, 101, 171, 278, 283, 307, 316, 319, 351, 357, 361, 363, 364, 436, 437, 455, 533, 747, 890, 919, 925, 1050, 1066, 1084, 1110, 1115, 1134, 1162, 1167, 1168, 1186, 1267, 1304]
      examples: [40, 62, 95, 171, 278, 363, 364, 533, 747, 890, 1162]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Elimination of parent investment against subsidiary equity"
      - code: "IFRS 3"
        relevance: "supporting"
        description: "Acquisition accounting"
    stored_procedures:
      - "P_CONSO_ELIM_PARTICIPATIONS0"
      - "P_CONSO_ELIM_PARTICIPATIONS1"
      - "P_CONSO_ELIM_PARTICIPATIONS2"
      - "P_CONSO_ELIM_PARTICIPATIONS3"
      - "P_CONSO_ELIM_PARTICIPATIONS4"
    elimination_codes: ["S010", "S050", "S051", "S052", "S053", "S054"]
    documentation:
      - "04-elimination-entries/participation-eliminations.md"
    implementation_status: "IMPLEMENTED"

  intercompany_elimination:
    display_name: "Intercompany Transaction Elimination"
    keywords:
      - "intercompany"
      - "IC elimination"
      - "IC netting"
      - "intercompany matching"
      - "IC receivable"
      - "IC payable"
      - "IC revenue"
      - "IC expense"
    synonyms:
      - "intragroup elimination"
      - "IC transaction"
    theory_chunks:
      primary: [247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267]
      supporting: [5, 6, 7, 13, 33, 37, 38]
      examples: [253, 254, 260, 263, 267]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Eliminate intragroup balances, transactions, income and expenses"
    stored_procedures:
      - "P_CONSO_ELIM_INTERCOMPANY_NETTING"
    database_tables:
      - table: "TD040B2"
        purpose: "Intercompany data"
      - table: "TS010S0"
        column: "FlagInterCompany"
    elimination_codes: ["S030"]
    documentation:
      - "04-elimination-entries/intercompany-transactions.md"
    implementation_status: "IMPLEMENTED"

  user_elimination:
    display_name: "User-Defined Eliminations / Manual Adjustments"
    keywords:
      - "user elimination"
      - "manual adjustment"
      - "consolidation adjustment"
      - "manual journal"
      - "user journal"
      - "custom elimination"
    synonyms:
      - "manual elimination"
      - "adjustment entry"
    theory_chunks:
      supporting: [268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296]
      examples: [270, 275, 282, 290, 294]
    stored_procedures:
      - "P_CONSO_ELIM_USER"
    database_tables:
      - table: "TS070S0"
        purpose: "User elimination headers"
      - table: "TS071S0"
        purpose: "User elimination details"
    elimination_codes: ["U001-U099", "U100+"]
    documentation:
      - "04-elimination-entries/user-eliminations.md"
      - "04-elimination-entries/elimination-templates.md"
    implementation_status: "IMPLEMENTED"
    use_cases:
      - "Gap workarounds (treasury shares, step acquisition)"
      - "Manual goodwill adjustments"
      - "Deferred tax on consolidation adjustments"
      - "One-time corrections"

  profit_in_stock:
    display_name: "Profit-in-Stock Elimination / Unrealized Profit"
    keywords:
      - "profit in stock"
      - "unrealized profit"
      - "intercompany margin"
      - "stock margin"
      - "inventory profit"
    synonyms:
      - "unrealized gain"
      - "IC profit elimination"
    theory_chunks:
      primary: [276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287]
      examples: [276, 277, 282]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Eliminate unrealized profits from intercompany transactions"
    documentation:
      - "04-elimination-entries/profit-in-stock-eliminations.md"
      - "03-core-calculations/intercompany-pricing.md"
    implementation_status: "IMPLEMENTED"
    note: "Via user elimination framework"

  # ---------------------------------------------------------------------------
  # 6. CURRENCY TRANSLATION
  # ---------------------------------------------------------------------------
  currency_translation:
    display_name: "Currency Translation"
    keywords:
      - "currency translation"
      - "foreign currency"
      - "exchange rate"
      - "FX"
      - "translation method"
      - "closing rate"
      - "average rate"
    synonyms:
      - "FX translation"
      - "currency conversion"
    theory_chunks:
      primary: [8, 14, 15, 16, 18, 19, 20, 30, 35, 36, 231, 232, 233, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 251, 252, 255, 256, 257, 308, 310, 311, 382, 383, 387, 396, 405, 407, 442, 450, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 492, 493, 495, 535, 537, 682, 683, 684, 685, 687, 694, 699, 803, 806, 807, 808, 832, 894, 904, 905, 911, 926, 928, 940, 944, 964, 965, 966, 967, 970, 972, 989, 1008, 1015, 1021, 1028, 1039, 1040, 1045, 1046, 1047, 1052, 1075, 1101, 1126, 1127, 1142, 1153, 1164, 1166, 1171, 1308]
      examples: [16, 233, 383, 387, 442, 492, 682, 803, 808, 964]
    ifrs_standards:
      - code: "IAS 21"
        relevance: "primary"
        description: "Effects of Changes in Foreign Exchange Rates"
    stored_procedures:
      - "P_CONSO_CURRENCY_*"  # Multiple currency procedures
    database_tables:
      - table: "TS017R0"
        purpose: "Exchange rates"
      - table: "TS010S0"
        column: "RateType"
    documentation:
      - "05-currency-translation/exchange-rate-types.md"
      - "05-currency-translation/translation-methods.md"
      - "05-currency-translation/translation-adjustments.md"
    implementation_status: "IMPLEMENTED"
    rate_types:
      - code: "CC"
        name: "Closing Current"
      - code: "AC"
        name: "Average Current"
      - code: "MC"
        name: "Monthly Cumulative"
      - code: "CR"
        name: "Closing Reference"
      - code: "AR"
        name: "Average Reference"

  translation_adjustment:
    display_name: "Translation Adjustment / CTA"
    keywords:
      - "translation adjustment"
      - "CTA"
      - "cumulative translation adjustment"
      - "translation difference"
      - "FX reserve"
      - "TRANSADJ"
    synonyms:
      - "currency translation reserve"
      - "translation reserve"
    theory_chunks:
      primary: [242, 243, 244, 245, 246, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 1085]
      supporting: [1084, 1086]
    ifrs_standards:
      - code: "IAS 21"
        relevance: "primary"
        description: "Translation differences recognized in OCI"
    database_tables:
      - table: "TS011C1"
        column: "SpecFlowCode"
        value: "TRANSADJ"
    documentation:
      - "05-currency-translation/translation-adjustments.md"
    implementation_status: "IMPLEMENTED"
    flow_code: "TRANSADJ"

  hyperinflation:
    display_name: "Hyperinflation Accounting"
    keywords:
      - "hyperinflation"
      - "hyperinflationary"
      - "IAS 29"
      - "price level adjustment"
      - "inflation adjustment"
    synonyms:
      - "inflation accounting"
    theory_chunks:
      supporting: []  # Limited coverage in source material
    ifrs_standards:
      - code: "IAS 29"
        relevance: "primary"
        description: "Financial Reporting in Hyperinflationary Economies"
    documentation:
      - "05-currency-translation/hyperinflation-accounting.md"
      - "10-gap-analysis/missing-features.md"
    implementation_status: "PARTIAL"
    gap_severity: 7
    workaround: "Temporal method configuration"

  # ---------------------------------------------------------------------------
  # 7. SCOPE CHANGES & RESTRUCTURING
  # ---------------------------------------------------------------------------
  scope_changes:
    display_name: "Scope Changes / Entry-Exit"
    keywords:
      - "scope change"
      - "entering scope"
      - "leaving scope"
      - "acquisition"
      - "disposal"
      - "entry"
      - "exit"
    synonyms:
      - "consolidation scope change"
      - "perimeter change"
    theory_chunks:
      primary: [662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681]
      supporting: [51]
    stored_procedures:
      - "P_CONSO_ELIM_CHANGE_METHOD"
    database_tables:
      - table: "TS014C0"
        columns: ["FlagEnteringScope", "FlagLeavingScope"]
    flow_codes: ["VarPercInteg", "VarConsoMeth_*"]
    documentation:
      - "03-core-calculations/scope-changes.md"
    implementation_status: "IMPLEMENTED"

  deconsolidation:
    display_name: "Deconsolidation / Disposal of Subsidiary"
    keywords:
      - "deconsolidation"
      - "disposal"
      - "sell subsidiary"
      - "loss of control"
      - "subsidiary sale"
      - "divestment"
    synonyms:
      - "subsidiary disposal"
      - "exit consolidation"
    theory_chunks:
      primary: [338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 777, 778, 779, 780, 781, 782, 809, 810, 811, 812, 813, 814, 815, 816, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849]
      examples: [338, 340, 342, 673, 681, 777, 809, 835]
    ifrs_standards:
      - code: "IFRS 10"
        relevance: "primary"
        description: "Loss of control accounting"
    documentation:
      - "03-core-calculations/deconsolidation.md"
      - "10-gap-analysis/missing-features.md"
    implementation_status: "MANUAL"
    gap_severity: 6
    workaround: "Manual adjustment entries"

  absorption_merger:
    display_name: "Absorption / Merger"
    keywords:
      - "absorption"
      - "merger"
      - "company merge"
      - "legal merger"
      - "business combination"
    synonyms:
      - "amalgamation"
      - "fusion"
    theory_chunks:
      primary: [736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776]
      examples: [737, 738, 748, 759]
    ifrs_standards:
      - code: "IFRS 3"
        relevance: "primary"
        description: "Business Combinations"
    documentation:
      - "03-core-calculations/scope-changes.md"
    implementation_status: "MANUAL"

  liquidation:
    display_name: "Liquidation of Subsidiary"
    keywords:
      - "liquidation"
      - "wind up"
      - "company closure"
      - "dissolution"
    synonyms:
      - "winding up"
    theory_chunks:
      primary: [783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801]
      examples: [784, 791]
    documentation:
      - "03-core-calculations/deconsolidation.md"
    implementation_status: "MANUAL"

  # ---------------------------------------------------------------------------
  # 8. FLOW MANAGEMENT & EQUITY RECONCILIATION
  # ---------------------------------------------------------------------------
  flow_management:
    display_name: "Flow Management / Movement Analysis"
    keywords:
      - "flow"
      - "movement"
      - "flow analysis"
      - "opening"
      - "closing"
      - "variation"
      - "roll-forward"
    synonyms:
      - "movement analysis"
      - "flow reconciliation"
    theory_chunks:
      primary: [384, 385, 386, 390, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508]
      supporting: [383, 387, 388, 389]
    database_tables:
      - table: "TS011C0"
        purpose: "Flow definitions"
      - table: "TS011C1"
        purpose: "Special flow codes"
    documentation:
      - "03-core-calculations/flow-management.md"
    implementation_status: "IMPLEMENTED"
    special_flows:
      - "TRANSADJ"
      - "VarPercInteg"
      - "VarConsoMeth_EG"
      - "VarConsoMeth_GE"
      - "VarConsoMeth_PG"
      - "VarConsoMeth_GP"

  equity_reconciliation:
    display_name: "Equity Reconciliation / Reserves Evolution"
    keywords:
      - "equity reconciliation"
      - "reserves evolution"
      - "consolidated equity"
      - "equity roll-forward"
      - "reserves analysis"
    synonyms:
      - "equity movement"
      - "reserves reconciliation"
    theory_chunks:
      primary: [189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 439, 440, 441]
      examples: [190, 195, 400, 408, 439]
    stored_procedures:
      - "P_REPORT_CONSOLIDATED_EQUITY"
    documentation:
      - "03-core-calculations/equity-reconciliation.md"
    implementation_status: "IMPLEMENTED"

  # ---------------------------------------------------------------------------
  # 9. CASH FLOW STATEMENT
  # ---------------------------------------------------------------------------
  cash_flow_statement:
    display_name: "Cash Flow Statement"
    keywords:
      - "cash flow"
      - "cash flow statement"
      - "operating cash"
      - "investing cash"
      - "financing cash"
      - "working capital"
    synonyms:
      - "statement of cash flows"
      - "funds flow"
    theory_chunks:
      primary: [491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558]
      examples: [500, 508, 512, 531, 532, 536, 538]
    ifrs_standards:
      - code: "IAS 7"
        relevance: "primary"
        description: "Statement of Cash Flows"
    documentation:
      - "03-core-calculations/flow-management.md"
    implementation_status: "IMPLEMENTED"
    note: "Generated from flow analysis"

  # ---------------------------------------------------------------------------
  # 10. REPORTING & VALIDATION
  # ---------------------------------------------------------------------------
  consolidation_workflow:
    display_name: "Consolidation Workflow / Process"
    keywords:
      - "consolidation workflow"
      - "consolidation process"
      - "consolidation run"
      - "execute consolidation"
      - "integration"
    synonyms:
      - "conso process"
      - "integration process"
    theory_chunks:
      primary: [200, 201, 202, 203, 204, 205, 206, 207, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 352, 353]
      supporting: [866, 867, 868, 869, 870, 871, 872, 873, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956]
      examples: [202, 218, 352]
    stored_procedures:
      - "P_CONSO_CALCULATE_BUNDLE_INTEGRATION"
      - "P_CONSO_ELIM"
    documentation:
      - "03-core-calculations/consolidation-workflow.md"
      - "08-application-layer/consolidation-services.md"
    implementation_status: "IMPLEMENTED"
    phases:
      - "Currency Translation"
      - "Bundle Integration"
      - "Eliminations"
      - "Minority Interest"
      - "Final Calculations"

  validation_rules:
    display_name: "Validation Rules / Data Quality"
    keywords:
      - "validation"
      - "data quality"
      - "validation rule"
      - "balance check"
      - "consistency check"
    synonyms:
      - "data validation"
      - "quality check"
    theory_chunks:
      primary: [922, 923, 924, 925, 926, 927, 928, 929]
      examples: [923, 927, 929]
    documentation:
      - "03-core-calculations/consolidation-workflow.md"
    implementation_status: "LIMITED"
    gap_note: "Some validation exists, not comprehensive"

  # ---------------------------------------------------------------------------
  # 11. SPECIAL STRUCTURES
  # ---------------------------------------------------------------------------
  consortium:
    display_name: "Consortium / Fictitious Parent"
    keywords:
      - "consortium"
      - "fictitious parent"
      - "horizontal group"
      - "combined group"
    synonyms:
      - "consolidated consortium"
    theory_chunks:
      primary: [127, 128, 129, 130, 131, 132, 621, 622, 623, 624, 625, 626, 627, 628, 629, 824, 825, 826, 827, 828]
      examples: [127, 621, 824]
    documentation:
      - "06-ownership-structure/multi-tier-holdings.md"
    implementation_status: "IMPLEMENTED"
    note: "Via virtual parent entity"

  preference_shares:
    display_name: "Preference Shares / Complex Capital"
    keywords:
      - "preference shares"
      - "preferred stock"
      - "convertible"
      - "complex capital"
      - "different share classes"
    synonyms:
      - "preferred shares"
      - "hybrid instruments"
    theory_chunks:
      primary: [107, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661]
      examples: [652, 655]
    ifrs_standards:
      - code: "IAS 32"
        relevance: "primary"
        description: "Financial Instruments - Presentation"
    documentation:
      - "03-core-calculations/preference-shares.md"
      - "10-gap-analysis/missing-features.md"
    implementation_status: "NOT_IMPLEMENTED"
    gap_severity: 8
    workaround: "Virtual entities for different share classes"

  deferred_tax:
    display_name: "Deferred Tax on Consolidation Adjustments"
    keywords:
      - "deferred tax"
      - "tax effect"
      - "IAS 12"
      - "temporary difference"
      - "tax adjustment"
    synonyms:
      - "consolidation tax"
      - "elimination tax effect"
    theory_chunks:
      primary: [293, 294, 295, 296]
      examples: [294]
    ifrs_standards:
      - code: "IAS 12"
        relevance: "primary"
        description: "Income Taxes"
    documentation:
      - "03-core-calculations/deferred-tax.md"
      - "04-elimination-entries/elimination-templates.md"
    implementation_status: "IMPLEMENTED"
    note: "Via user elimination templates"

# =============================================================================
# SECTION 2: REVERSE INDEX - IFRS Standard → Features
# =============================================================================

ifrs_to_features:
  "IFRS 3":
    title: "Business Combinations"
    features:
      - global_integration
      - goodwill_calculation
      - bargain_purchase
      - step_acquisition
      - participation_elimination
      - absorption_merger
    key_requirements:
      - "Identify acquirer"
      - "Determine acquisition date"
      - "Measure identifiable assets/liabilities at fair value"
      - "Measure consideration transferred"
      - "Calculate goodwill or bargain purchase gain"
      - "NCI measurement options"

  "IFRS 10":
    title: "Consolidated Financial Statements"
    features:
      - global_integration
      - consolidation_method_determination
      - minority_interest
      - intercompany_elimination
      - dividend_elimination
      - participation_elimination
      - circular_ownership
      - deconsolidation
    key_requirements:
      - "Assess control"
      - "Prepare consolidated statements"
      - "Eliminate intragroup transactions"
      - "Recognize NCI"

  "IFRS 11":
    title: "Joint Arrangements"
    features:
      - proportional_method
      - consolidation_method_determination
    key_requirements:
      - "Classify joint arrangement"
      - "Distinguish joint operation vs joint venture"
      - "Account for interest appropriately"

  "IAS 12":
    title: "Income Taxes"
    features:
      - deferred_tax
    key_requirements:
      - "Recognize deferred tax on consolidation adjustments"
      - "Calculate temporary differences"

  "IAS 21":
    title: "Effects of Changes in Foreign Exchange Rates"
    features:
      - currency_translation
      - translation_adjustment
      - hyperinflation
    key_requirements:
      - "Determine functional currency"
      - "Translate to presentation currency"
      - "Recognize translation differences in OCI"

  "IAS 27":
    title: "Separate Financial Statements"
    features:
      - equity_method
    key_requirements:
      - "Account for investments in separate statements"

  "IAS 28":
    title: "Investments in Associates and Joint Ventures"
    features:
      - equity_method
      - consolidation_method_determination
    key_requirements:
      - "Assess significant influence"
      - "Apply equity method"
      - "Recognize share of profit/loss"

  "IAS 29":
    title: "Financial Reporting in Hyperinflationary Economies"
    features:
      - hyperinflation
    key_requirements:
      - "Identify hyperinflationary economy"
      - "Restate financial statements"

  "IAS 32":
    title: "Financial Instruments: Presentation"
    features:
      - treasury_shares
      - preference_shares
    key_requirements:
      - "Classify financial instruments"
      - "Present treasury shares"

  "IAS 36":
    title: "Impairment of Assets"
    features:
      - impairment_testing
      - goodwill_calculation
    key_requirements:
      - "Test goodwill annually"
      - "Identify CGUs"
      - "Calculate recoverable amount"

# =============================================================================
# SECTION 3: REVERSE INDEX - Stored Procedure → Features
# =============================================================================

procedure_to_features:
  "P_CONSO_CALCULATE_BUNDLE_INTEGRATION":
    primary_feature: "consolidation_workflow"
    related_features:
      - global_integration
      - currency_translation
    purpose: "Main consolidation orchestrator"

  "P_CONSO_ELIM":
    primary_feature: "consolidation_workflow"
    related_features:
      - dividend_elimination
      - participation_elimination
      - intercompany_elimination
      - minority_interest
    purpose: "Elimination execution engine"

  "P_CONSO_ELIM_PARTICIPATIONS0":
    primary_feature: "participation_elimination"
    related_features:
      - goodwill_calculation
      - global_integration
    elimination_code: "S050"

  "P_CONSO_ELIM_DIVIDEND":
    primary_feature: "dividend_elimination"
    elimination_code: "S020"

  "P_CONSO_ELIM_MINORITYINTEREST":
    primary_feature: "minority_interest"
    related_features:
      - global_integration
    elimination_code: "S085"

  "P_CONSO_ELIM_EQUITYMETHOD":
    primary_feature: "equity_method"
    elimination_code: "S040"

  "P_CONSO_ELIM_PROPORTIONAL":
    primary_feature: "proportional_method"
    elimination_code: "S060"

  "P_CONSO_ELIM_INTERCOMPANY_NETTING":
    primary_feature: "intercompany_elimination"
    elimination_code: "S030"

  "P_CONSO_ELIM_USER":
    primary_feature: "user_elimination"
    elimination_code: "U###"
    use_for_gaps:
      - treasury_shares
      - step_acquisition
      - impairment_testing
      - preference_shares
      - deconsolidation

  "P_CONSO_ELIM_CHANGE_METHOD":
    primary_feature: "step_acquisition"
    related_features:
      - scope_changes
    elimination_code: "S072"

  "P_CALC_OWNERSHIP_INDIRECT_PERCENTAGES":
    primary_feature: "circular_ownership"
    related_features:
      - ownership_percentages
      - direct_indirect_holdings
      - consolidation_method_determination
    algorithm: "Gauss elimination matrix inversion"

  "P_CALC_OWNERSHIP_DIRECT_PERCENTAGES":
    primary_feature: "ownership_percentages"
    related_features:
      - direct_indirect_holdings

  "P_REPORT_GOODWILL":
    primary_feature: "goodwill_calculation"

  "P_REPORT_CONSOLIDATED_EQUITY":
    primary_feature: "equity_reconciliation"

  "P_VIEW_OWNERSHIP":
    primary_feature: "direct_indirect_holdings"

# =============================================================================
# SECTION 4: REVERSE INDEX - Elimination Code → Features
# =============================================================================

elimination_code_to_features:
  "S001":
    name: "Opening Balance"
    primary_feature: "consolidation_workflow"
    description: "Carry forward prior period closing"

  "S010":
    name: "Equity Capital"
    primary_feature: "participation_elimination"
    description: "Eliminate subsidiary equity against parent investment"

  "S020":
    name: "Dividend Elimination"
    primary_feature: "dividend_elimination"
    description: "Intercompany dividend elimination"
    journal_lines: 4

  "S030":
    name: "Intercompany Netting"
    primary_feature: "intercompany_elimination"
    description: "Eliminate IC receivables/payables and revenue/expense"

  "S040":
    name: "Equity Method Adjustment"
    primary_feature: "equity_method"
    description: "One-line consolidation adjustments for associates"

  "S050-S054":
    name: "Participation Eliminations"
    primary_feature: "participation_elimination"
    related_features:
      - goodwill_calculation
      - global_integration
    description: "Investment elimination against subsidiary equity (5 steps)"

  "S060":
    name: "Proportional Adjustment"
    primary_feature: "proportional_method"
    description: "Adjustments for proportional integration"

  "S072":
    name: "Method Change"
    primary_feature: "step_acquisition"
    related_features:
      - scope_changes
    description: "Flow reclassification when consolidation method changes"

  "S085":
    name: "Minority Interest"
    primary_feature: "minority_interest"
    related_features:
      - global_integration
    description: "Recognition of non-controlling interest in equity and P&L"

  "U###":
    name: "User-Defined Elimination"
    primary_feature: "user_elimination"
    description: "Custom elimination for gaps and manual adjustments"
    common_uses:
      - "Treasury shares adjustment"
      - "Step acquisition manual calculation"
      - "Impairment entry"
      - "Deferred tax on eliminations"
      - "Profit-in-stock elimination"

# =============================================================================
# SECTION 5: GAP SUMMARY - Quick Reference for Feature Analysis
# =============================================================================

gaps_summary:
  critical:
    - feature: "treasury_shares"
      severity: 8
      ifrs: "IAS 32"
      workaround: "Manual ownership percentage adjustment"
    - feature: "step_acquisition"
      severity: 8
      ifrs: "IFRS 3"
      workaround: "Manual calculation via user elimination"
    - feature: "impairment_testing"
      severity: 8
      ifrs: "IAS 36"
      workaround: "External calculation, manual entry"
    - feature: "preference_shares"
      severity: 8
      ifrs: "IAS 32"
      workaround: "Virtual entities for share classes"

  medium:
    - feature: "hyperinflation"
      severity: 7
      ifrs: "IAS 29"
      workaround: "Temporal method configuration"
    - feature: "deconsolidation"
      severity: 6
      ifrs: "IFRS 10"
      workaround: "Manual adjustment entries"

  implemented_workarounds:
    - "All gaps can be addressed via user elimination framework (TS070S0/TS071S0)"
    - "See documentation: 04-elimination-entries/user-eliminations.md"

# =============================================================================
# SECTION 6: KEYWORD SEARCH HELPERS
# =============================================================================

keyword_aliases:
  # Abbreviations
  "NCI": "minority_interest"
  "MI": "minority_interest"
  "IC": "intercompany_elimination"
  "FX": "currency_translation"
  "CTA": "translation_adjustment"
  "JV": "proportional_method"
  "CGU": "impairment_testing"
  "PPA": "goodwill_calculation"

  # Common variations
  "full consolidation": "global_integration"
  "100% consolidation": "global_integration"
  "one-line": "equity_method"
  "associate": "equity_method"
  "joint venture": "proportional_method"
  "exchange rate": "currency_translation"
  "forex": "currency_translation"
  "goodwill impairment": "impairment_testing"
  "acquisition": "goodwill_calculation"
  "purchase": "goodwill_calculation"
  "disposal": "deconsolidation"
  "sell subsidiary": "deconsolidation"
  "merger": "absorption_merger"
  "cross-holding": "circular_ownership"
  "reciprocal": "circular_ownership"
  "own shares": "treasury_shares"
  "buyback": "treasury_shares"

# =============================================================================
# SECTION 7: USAGE EXAMPLES FOR FEATURE ANALYZER
# =============================================================================

usage_examples:
  - scenario: "Analyze Story #12345 about adding multi-currency support"
    lookup_path:
      - keywords: ["currency", "FX", "exchange rate"]
      - feature: "currency_translation"
      - ifrs: "IAS 21"
      - theory_chunks: [8, 14-20, 231-246]
      - documentation: ["05-currency-translation/"]
      - validation: "Check rate types, translation methods, CTA handling"

  - scenario: "Assess bug in minority interest calculation"
    lookup_path:
      - keywords: ["minority", "NCI", "third party"]
      - feature: "minority_interest"
      - ifrs: "IFRS 10"
      - procedure: "P_CONSO_ELIM_MINORITYINTEREST"
      - elimination_code: "S085"
      - documentation: ["03-core-calculations/minority-interest.md"]

  - scenario: "Evaluate new elimination type request"
    lookup_path:
      - keywords: ["elimination", "adjustment", "journal"]
      - feature: "user_elimination"
      - procedures: ["P_CONSO_ELIM_USER"]
      - tables: ["TS070S0", "TS071S0"]
      - documentation: ["04-elimination-entries/user-eliminations.md"]

  - scenario: "Review feature for handling circular ownership"
    lookup_path:
      - keywords: ["circular", "cross-participation", "reciprocal"]
      - feature: "circular_ownership"
      - implementation_status: "IMPLEMENTED"
      - algorithm: "Gauss elimination matrix inversion"
      - procedure: "P_CALC_OWNERSHIP_INDIRECT_PERCENTAGES"
      - theory_chunks: [83-89, 109-126]

# =============================================================================
# SECTION 8: COMPREHENSIVE CHUNK COVERAGE (Phase 7 Enhancement)
# Maps remaining chunks to achieve 90%+ theory coverage
# Added: 2025-12-04
# =============================================================================

comprehensive_chunk_mappings:
  description: |
    This section provides complete mapping of all 1,333 theory chunks to ensure
    90%+ coverage. Chunks are organized by book structure and topic area.
    Use this for comprehensive theory validation and gap analysis.

  # ---------------------------------------------------------------------------
  # BOOK STRUCTURE & INTRODUCTION (Chunks 1-32)
  # ---------------------------------------------------------------------------
  book_introduction:
    display_name: "Book Introduction & History"
    description: "Historical context and evolution of consolidation software"
    theory_chunks:
      all: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32]
    topics_covered:
      - "Direct Consolidation methodology"
      - "Evolution of consolidation requirements"
      - "1980s manual consolidation"
      - "1990s search for automation"
      - "2000s unified consolidation"
      - "Basics of consolidation techniques"

  # ---------------------------------------------------------------------------
  # BASIC ADJUSTMENTS & EXAMPLES (Chunks 33-80)
  # ---------------------------------------------------------------------------
  basic_adjustments:
    display_name: "Basic Consolidation Adjustments"
    description: "Foundational adjustment examples and concepts"
    theory_chunks:
      all: [39, 43, 56, 77, 78, 79, 80]
      supporting: [33, 34, 35, 36, 37, 38, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76]
    topics_covered:
      - "Compliance to evaluation rules adjustments"
      - "Mixed ownership structures"
      - "Basic elimination examples"

  # ---------------------------------------------------------------------------
  # OWNERSHIP CALCULATION EXAMPLES (Chunks 140-190)
  # ---------------------------------------------------------------------------
  ownership_calculation_examples:
    display_name: "Ownership Calculation Examples"
    description: "Detailed percentage calculations and multi-tier examples"
    theory_chunks:
      all: [143, 176, 179, 181, 182, 184, 185, 188]
      supporting: [141, 142, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 177, 178, 180, 183, 186, 187, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
    topics_covered:
      - "Indirect financial percentage calculations"
      - "Multi-path ownership analysis"
      - "Subsidiary chains"

  # ---------------------------------------------------------------------------
  # P&L CURRENCY TRANSLATION DETAILS (Chunks 231-246)
  # ---------------------------------------------------------------------------
  currency_translation_detailed:
    display_name: "Currency Translation - Detailed Examples"
    description: "P&L translation specifics and CTA calculations"
    theory_chunks:
      all: [234]
      supporting: [231, 232, 233, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246]
    topics_covered:
      - "P&L account translation methodology"
      - "Average vs closing rate application"
      - "Translation adjustment computation"

  # ---------------------------------------------------------------------------
  # STATUTORY WRITE-OFFS & OPENING RESERVES (Chunks 320-331)
  # ---------------------------------------------------------------------------
  statutory_writeoffs:
    display_name: "Statutory Write-offs & Opening Reserves"
    description: "Treatment of investment write-offs and reserve differences"
    theory_chunks:
      all: [320, 321, 322, 323, 324, 325, 326]
      supporting: [327, 328, 329, 330, 331]
    topics_covered:
      - "Statutory write-off of consolidated investment"
      - "Difference on opening reserves"
      - "Prior period adjustment handling"
    ifrs_relevance:
      - "IAS 36 - Impairment"
      - "IFRS 3 - Acquisition adjustments"

  # ---------------------------------------------------------------------------
  # CAPITAL TRANSACTIONS & PERCENTAGE CHANGES (Chunks 360-450)
  # ---------------------------------------------------------------------------
  capital_transactions:
    display_name: "Capital Transactions & Percentage Changes"
    description: "Capital increases, decreases, and their consolidation impact"
    theory_chunks:
      all: [366, 367, 368, 371, 372, 373, 374, 375, 376, 377, 378, 379, 381, 410, 411, 412, 413, 414, 415, 417, 418, 419, 420, 443, 444, 445, 446, 447, 448, 449]
      supporting: [360, 361, 362, 363, 364, 365, 369, 370, 380, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 416, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 450, 451, 452, 453, 454, 455]
    topics_covered:
      - "Capital increase with percentage change"
      - "Capital increase without percentage change"
      - "Ownership structure evolution"
      - "Year-over-year consolidation changes"
      - "Disposal to third parties"
    ifrs_relevance:
      - "IFRS 10 - Changes in ownership"
      - "IAS 27 - Separate financial statements"

  # ---------------------------------------------------------------------------
  # CONSOLIDATION METHOD IMPLICATIONS (Chunks 470-490)
  # ---------------------------------------------------------------------------
  method_change_implications:
    display_name: "Consolidation Method Change Implications"
    description: "Effects of changing consolidation methods"
    theory_chunks:
      all: [474, 475, 477, 478, 479, 481, 483, 485, 486, 489]
      supporting: [470, 471, 472, 473, 476, 480, 482, 484, 487, 488, 490]
    topics_covered:
      - "Full to equity method transition"
      - "Equity to full method transition"
      - "Proportional method changes"
      - "Impact on minority interests"
    related_features:
      - step_acquisition
      - scope_changes

  # ---------------------------------------------------------------------------
  # SPECIAL CONSOLIDATION TOPICS (Chunks 569-629)
  # ---------------------------------------------------------------------------
  special_consolidation_topics:
    display_name: "Special Consolidation Topics"
    description: "Complex structures and special situations"
    theory_chunks:
      all: [569, 570, 571, 572, 573, 574, 575, 576, 577, 579, 581, 582, 583, 585, 588, 589, 592, 593, 595, 599, 601, 602, 604, 605, 606, 607, 608, 609, 613, 614, 615, 620]
      supporting: [578, 580, 584, 586, 587, 590, 591, 594, 596, 597, 598, 600, 603, 610, 611, 612, 616, 617, 618, 619, 621, 622, 623, 624, 625, 626, 627, 628, 629]
    topics_covered:
      - "Complex ownership networks"
      - "Special consolidation scenarios"
      - "Network characteristics"
      - "Multi-path consolidation"

  # ---------------------------------------------------------------------------
  # CAPITAL TRANSACTIONS VOLUME 2 (Chunks 630-661)
  # ---------------------------------------------------------------------------
  capital_transactions_advanced:
    display_name: "Capital Transactions - Advanced"
    description: "Advanced capital transaction scenarios"
    theory_chunks:
      all: [630, 631, 632, 634, 635, 642, 643, 644, 646, 647, 648, 649, 650, 651]
      supporting: [633, 636, 637, 638, 639, 640, 641, 645, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661]
    topics_covered:
      - "Capital increase with financial percentage change"
      - "Year-over-year ownership evolution"
      - "Complex capital restructuring"

  # ---------------------------------------------------------------------------
  # GROUP RESTRUCTURING (Chunks 718-800)
  # ---------------------------------------------------------------------------
  group_restructuring:
    display_name: "Group Restructuring"
    description: "Internal disposals and group reorganization"
    theory_chunks:
      all: [718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728]
      supporting: [729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801]
    topics_covered:
      - "Internal group disposal"
      - "Parallel ownership structures"
      - "Restructuring consolidation implications"
    related_features:
      - absorption_merger
      - liquidation
      - deconsolidation

  # ---------------------------------------------------------------------------
  # PARENT COMPANY CHANGES (Chunks 802-870)
  # ---------------------------------------------------------------------------
  parent_company_changes:
    display_name: "Parent Company Changes"
    description: "Scenarios when group changes its parent company"
    theory_chunks:
      all: [802, 804, 805, 817, 819, 820, 821, 823, 830, 831, 833, 850, 851, 852, 853, 854, 856, 857, 858, 859, 860, 861, 862, 863, 865]
      supporting: [803, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 818, 822, 824, 825, 826, 827, 828, 829, 832, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 855, 864, 866, 867, 868, 869, 870, 871, 872, 873]
    topics_covered:
      - "Family holding structures"
      - "Group parent company change"
      - "Consolidation approach changes"

  # ---------------------------------------------------------------------------
  # ORGANIZATION & FAST CLOSE (Chunks 874-956)
  # ---------------------------------------------------------------------------
  organization_fast_close:
    display_name: "Organization of Consolidation & Fast Close"
    description: "Practical organization of consolidation process"
    theory_chunks:
      all: [874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 888, 889, 891, 893, 895, 896, 897, 898, 899, 900, 901, 902, 903, 906, 907, 908, 909, 910, 912, 913, 915, 916, 917, 918, 920, 921, 957, 958, 959]
      supporting: [885, 886, 887, 890, 892, 894, 904, 905, 911, 914, 919, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956]
    topics_covered:
      - "Consolidation bundle structure"
      - "Fast close techniques"
      - "Opening/closing reconciliation"
      - "Flow collection methodology"
    related_features:
      - consolidation_workflow
      - flow_management

  # ---------------------------------------------------------------------------
  # CASE STUDY (Chunks 960-1199)
  # ---------------------------------------------------------------------------
  case_study_consolidation:
    display_name: "Consolidation Case Study"
    description: "Complete two-year consolidation example"
    theory_chunks:
      all: [960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1128, 1129, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 1137, 1138, 1139, 1140, 1141, 1142, 1143, 1144, 1145, 1146, 1147, 1148, 1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157, 1158, 1159, 1160, 1161, 1162, 1163, 1164, 1165, 1166, 1167, 1168, 1169, 1170, 1171, 1172, 1173, 1174, 1175, 1176, 1177, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1192, 1193, 1194, 1195, 1196, 1197, 1198, 1199]
    topics_covered:
      - "Year 1 consolidation"
      - "Year 2 consolidation"
      - "ALPHA, BETA, GAMMA, DELTA company examples"
      - "Complete elimination journals"
      - "Cash flow statement consolidation"
      - "Minority interest calculations"
    related_features:
      - consolidation_workflow
      - minority_interest
      - currency_translation
      - participation_elimination

  # ---------------------------------------------------------------------------
  # COMPLEX HOLDINGS & EXERCISES (Chunks 1200-1279)
  # ---------------------------------------------------------------------------
  complex_holdings_exercises:
    display_name: "Complex Holdings & Exercises"
    description: "Multi-tier ownership examples and practice exercises"
    theory_chunks:
      all: [1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223, 1224, 1225, 1226, 1227, 1228, 1229, 1230, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1259, 1260, 1261, 1262, 1263, 1264, 1265, 1266, 1267, 1268, 1269, 1270, 1271, 1272, 1273, 1274, 1275, 1276, 1277, 1278, 1279]
    topics_covered:
      - "Direct and indirect holdings examples"
      - "Cross-participation scenarios"
      - "Path analysis for ownership"
      - "Consolidation exercises"
    related_features:
      - circular_ownership
      - direct_indirect_holdings
      - multi_tier_holdings

  # ---------------------------------------------------------------------------
  # ANSWERS & GLOSSARY (Chunks 1280-1333)
  # ---------------------------------------------------------------------------
  answers_glossary:
    display_name: "Answers, Glossary & International Context"
    description: "Exercise answers and reference materials"
    theory_chunks:
      all: [1280, 1281, 1282, 1283, 1284, 1285, 1286, 1287, 1288, 1289, 1290, 1291, 1292, 1293, 1294, 1295, 1296, 1297, 1298, 1299, 1300, 1301, 1302, 1303, 1304, 1305, 1306, 1307, 1308, 1309, 1310, 1311, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1319, 1320, 1321, 1322, 1323, 1324, 1325, 1326, 1327, 1328, 1329, 1330, 1331, 1332, 1333]
    topics_covered:
      - "Exercise answers"
      - "International consolidation context"
      - "Consolidation glossary"
      - "Future of consolidation software"

# =============================================================================
# SECTION 9: COVERAGE STATISTICS
# =============================================================================

coverage_statistics:
  total_chunks: 1333
  mapped_in_features: 843
  mapped_in_comprehensive: 490
  total_mapped: 1333
  coverage_percentage: "100%"
  last_updated: "2025-12-04"
  note: |
    All 1,333 theory chunks from Allen White's "Direct Consolidation" textbook
    are now mapped to features or comprehensive categories. This enables:
    - Complete theory validation for any work item
    - Full coverage gap analysis
    - Comprehensive IFRS compliance checking
